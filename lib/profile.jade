template(name='user_layout')
    +nav
    with user_from_username_param
        .ui.stackable.padded.grid.pusher
            .row
                //- img.ui.image.checkin_banner(src="{{c.url banner_image width=1000 height=1000 crop='crop'}}")
                .four.wide.column
                    a.item.zoomer(href="/user/#{username}")
                        img.ui.centered.rounded.small.image(src="{{c.url image_id height=300 width=300 gravity='face' crop='fill'}}")
                    // .spacer
                    a.ui.header(href="/user/#{username}")
                        | #{username}
                    .ui.small.header.zoomer
                        strong
                            |#{current_user.points}
                        small
                            |current pts
                            span(title='rank') (##{current_user.point_rank})
                    .ui.small.header
                        strong
                            |#{current_user.total_received_points}
                        small
                            |pts received
                            // span(title='rank') (##{current_user.total_earned_credit_rank})
                    .ui.small.header
                        strong
                            |#{current_user.total_sent_points}
                        small
                            |pts sent
                            // span(title='rank') (##{current_user.total_bought_credit_rank})
                    div
                    if is_current_user
                        a.ui.basic.circular.icon.button.fly_up(href="/user/#{user_from_username_param.username}/edit" title='profile settings')
                            i.cog.large.icon
                    if is_current_user
                        .ui.basic.icon.button.logout.fly_down(title='log out')
                            i.sign.out.alternate.large.icon
                .twelve.wide.column
                    .spacer
                    +yield

        if in_role 'admin'
            +admin_footer


template(name='user_dashboard')
    .ui.big.button.send_points
        |send points
    with current_user       
        .ui.stackable.two.column.grid
            // if is_current_user
            
            .column.scrolling
                +user_received
            .column.scrolling
                +user_sent
                
                
                
template(name='user_received')
    .ui.header 
        |points received
    each received_transfers
        .ui.card
            .content
                a.header(href="/transfer/#{_id}") #{title}
                a.header(href="/transfer/#{_id}")
                    strong #{amount}pt
                    | to 
                    if target.image_id
                        img.ui.avatar.image(src="{{c.url target.image_id height=200 width=200 gravity='face' crop='fill'}}")
                    |#{target.username}
                small #{when}
                div
                |#{description}
                div
                each tags
                    .ui.mini.basic.label #{this}
                if in_dev
                    +print_this
        
        
        
template(name='user_sent')  
    .ui.inline.header 
        i.send.icon
        |sent
    .ui.basic.label #{total_sent_amount}p total sent
    .ui.basic.label(title='sent count') #{sent_count} gifts sent
    .ui.basic.label(title='rank') ##{global_sent_count_rank} gift sent rank
        
    i.tags.icon(title='credit tags')
    each sent_tags
        .ui.basic.circular.label #{title}
            small #{count}
        
    .ui.stackable.cards.scrolling
        each sent_items
            .ui.card
                .content
                    a.header(href="/transfer/#{_id}") #{title}
                    a.header(href="/transfer/#{_id}")
                        strong #{amount}pt
                        | to 
                        if target.image_id
                            img.ui.avatar.image(src="{{c.url target.image_id height=200 width=200 gravity='face' crop='fill'}}")
                        |#{target.username}
                    small #{when}
                    div
                    |#{description}
                    div
                    each tags
                        .ui.mini.basic.label #{this}
                    if in_dev 
                        +print_this
                                