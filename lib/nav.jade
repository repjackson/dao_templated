template(name='nav')
    #topnav.ui.fluid.attached.borderless.menu.topnav.hscroll
        unless connected
            .item 
                +status
        if connected
            // unless subs_ready
            //     .icon.item
            //         +i name='pizza' cl='spinning'
            //         // i.big.loading.grey.food.icon
            // else 
            a.icon.item.zoomer.toggle_leftbar.no_blink
               i.bars.large.icon 
            a.header.item.zoomer.fly_left(href='/' class="{{isActiveRoute regex='home'}}")
                img.ui.avatar.image(src="https://cdn.shopify.com/s/files/1/2432/4293/files/bcplogocirclestyle-2092x2107_1024x1024.png?v=1507416868")
                span.mobile.hidden backcountry
            // if session_is 'is_global_searching' true
            //     .ui.icon.transparent.input.global_search_input
            //         i.link.large.remove.white.icon.clear_search.zoomer(title='clear search')
            //         // if current_search
            //         // else
            //         //     i.search.icon
            //         input.global_search(type='text' value=current_search autocomplete="off")
            // else
            //     a.icon.item.init_global_search(title='search')
            //         i.search.large.icon
                
            // a.icon.item.mobile.hidden.zoomer(href='/events' class="{{isActiveRoute regex='events'}}" title='events')
            //     i.large.calendar.icon
            //     // |events
            if currentUser
                a.icon.item.mobile.hidden.zoomer(href="/m/food" class="{{isActiveRoute regex='food'}}" title='food')
                    +i name='food' cl='ui avatar image'
                a.icon.item.mobile.hidden.zoomer(href="/m/question" class="{{isActiveRoute regex='questions'}}" title='questions')
                    +i name='what' cl='ui avatar image'
                a.icon.item.mobile.hidden.zoomer(href="/m/drink" class="{{isActiveRoute regex='drinks'}}" title='drinks')
                    +i name='beer' cl='ui avatar image'
            a.icon.item.mobile.hidden.zoomer(href='/m/item' class="{{isActiveRoute regex='items'}}" title='inventory')
                +i name='grocery-shelf' cl='ui avatar image'
            a.icon.item.mobile.hidden.zoomer(href='/m/order' class="{{isActiveRoute regex='orders'}}" title='orders')
                +i name='money' cl='ui avatar image'
            // a.icon.item.mobile.hidden.zoomer(href="/losses" class="{{isActiveRoute regex='losses'}}" title='loss')
            //     +i name='loss' cl='ui avatar image'
            //     // i.large.frown.icon
            //     // |losses
            // a.icon.item.mobile.hidden.zoomer(href="/checkins" class="{{isActiveRoute regex='checkins'}}" title='checkins')
            //     +i name='checkmark' cl='ui avatar image'
            a.icon.item.mobile.hidden.zoomer(href='/users' class="{{isActiveRoute regex='users'}}" title='users')
                +i name='groups' cl='ui avatar image'
            a.icon.item.mobile.hidden.zoomer(href='/tasks' class="{{isActiveRoute regex='tasks'}}" title='tasks')
                +i name='tasks' cl='ui avatar image'
            a.icon.item.mobile.hidden.zoomer(href='/shop' class="{{isActiveRoute regex='shop'}}" title='shop')
                +i name='shopping-cart' cl='ui avatar image'
            .right.menu
                if currentUser
                    a.icon.item(href="/add")
                        i.large.green.plus.icon
                //     a.item.log_out(title='sign out')
                //         i.sign.out.icon
                //         |sign out
                // else 
                //     a.item(href="/login" title='sign in')
                //         i.sign.in.icon
                //         |sign in
                //       .right.menu
                if currentUser
                    if logging_out
                        .icon.item
                            i.large.food.loading.icon
                    else
                        // if in_role 'admin'
                        //     a.icon.item(href='/admin' title='admin')
                        //         i.large.shield.icon
                        a.icon.item.toggle_topbar(title='alerts')
                            i.bell.outline.large.icon
                        a.item(href="/user/#{currentUser.username}/points" class="{{isActiveRoute regex='user_points'}}")
                            // i.wallet.icon
                            strong {{int currentUser.points}}p
                        a.item.toggle_rightbar.no_blink
                            if currentUser.image_id
                                img.ui.avatar.image(src="{{c.url currentUser.image_id width=200 height=200 gravity='face'}}")
                            else
                                i.user.icon
                            strong.mobile.hidden #{currentUser.name}
                unless currentUser
                    if subs_ready
                        a.icon.item(href='/login' title='login') 
                            i.sign.in.large.icon
                    else 
                        i.food.loading.icon
         




template(name='not_found')
    .ui.center.aligned.basic.segment
        +ibig name='spill'
        .ui.header 
            // i.question.icon
            |'#{current_route}'
            |not found
        .ui.big.basic.ciruclar.button.browser_back
            i.undo.icon
            |back
            
            
template(name='topbar')
    .ui.fluid.attached.segment.topbar.top.sidebar
        .ui.middle.aligned.divided.list
            each recent_alerts
                +recent_alert
        a.ui.basic.button.item.close_topbar(href="/user/#{currentUser.username}/inbox")
            i.inbox.icon
            |inbox
        
template(name='recent_alert')        
    .item.alert
        .right.floated.content
            i.eye.link.icon.mark_read(title='mark read')
        img.ui.avatar.image(src="{{c.url author.profile_image_id height=200 width=200 gravity='face' crop='fill'}}")
        .content
            .header
                |#{description} 
            .description #{author.name} #{when}
            
            
            
            
// template(name='cartbar')
//     .ui.right.wide.sidebar.cartbar
//         +cart
        
template(name='walletbar')
    .ui.right.sidebar.walletbar
        +user_points
        
template(name='left_sidebar')
    .ui.left.wide.sidebar.filled
        // a.item.toggle_leftbar.no_blink(href='/' class="{{isActivePath '/'}}" title='home')
        //     img.ui.image(src="https://rosettahall.com/wp-content/uploads/2020/12/Rosetta-White-Transparent-Art-Board.png")
        // .search.item(title='search')
        //     .ui.icon.transparent.input
        //         i.search.icon
        //         input.search_global(type='text')
        +leftbar_nav_item label='food' icon='food' route='food'
        +leftbar_nav_item label='beer' icon='beer' route='drinks'
        +leftbar_nav_item label='inventory' icon='grocery-shelf' route='items'
        +leftbar_nav_item label='tasks' icon='tasks' route='tasks'
        // +leftbar_nav_item label='reviews' icon='feedback' route='reviews'
        // +leftbar_nav_item label='badges' icon='warranty' route='badges'
        +leftbar_nav_item label='orders' icon='order-history' route='orders'
        +leftbar_nav_item label='posts' icon='blog' route='posts'
        +leftbar_nav_item label='roles' icon='shield' route='roles'
        +leftbar_nav_item label='users' icon='groups' route='users'
        +leftbar_nav_item label='groups' icon='campfire' route='groups'
        +leftbar_nav_item label='images' icon='image' route='images'
        +leftbar_nav_item label='deliveries' icon='delivery' route='deliveries'
        +leftbar_nav_item label='ingredients' icon='ingredients' route='ingredients'
        +leftbar_nav_item label='recipes' icon='beer-recipe' route='recipes'
        +leftbar_nav_item label='questions' icon='question' route='questions'
        if is_admin
            .divider
            a.ui.button.set_model.toggle_leftbar.no_blink(href="/m/model" class="{{isActivePath '/m/model'}}")
                i.large.shield.icon
                |admin
            a.ui.button.set_user.toggle_leftbar.no_blink(href="/users" class="{{isActiveRoute '/users'}}")
                i.large.users.icon
                | users
            a.ui.button.toggle_leftbar.zoomer(href='/orders' class="{{isActivePath '/orders'}}" title='orders')
                i.large.list.icon
                | orders

template(name='leftbar_nav_item')
    a.ui.basic.big.image.label.spaced.toggle_leftbar.zoomer(href="/#{route}" class="{{isActiveRoute regex=route}}")
        +i name=icon cl='ui avatar image'
        | #{label}



template(name='right_sidebar')
    // .ui.right.sidebar.vertical.menu.rightbar(style="background-color:#062639;")
    .ui.right.wide.sidebar.rightbar.filled
        with currentUser
            a.ui.basic.compact.button.toggle_rightbar.no_blink(href="/user/#{username}" class="{{isActiveRoute 'user_layout'}}")
                img.ui.avatar.compact.image(src="{{c.url image_id height=200 width=200 gravity='face' crop='fill'}}")
                |#{name}
                small (#{currentUser.username})
            a.ui.basic.compact.button.toggle_rightbar(href="/user/#{username}" class="{{isActiveRoute regex='user_dashboard'}}")
                +i name='dashboard' cl='ui avatar image'
                | dashboard
            +rightbar_nav_item label='compare' icon='exchange' route='compare'
            +rightbar_nav_item label='checkins' icon='satisfaction' route='checkins'
            +rightbar_nav_item label='posts' icon='blog' route='posts'
            +rightbar_nav_item label='topups' icon='donation' route='topups'
            +rightbar_nav_item label='work' icon='services' route='work'
            +rightbar_nav_item label='tasks' icon='tasks' route='tasks'
            +rightbar_nav_item label='chat' icon='chat' route='chat'
            // +rightbar_nav_item label='badges' icon='prize' route='badges'
            // +rightbar_nav_item label='timeclock' icon='clock' route='timeclock'
            // +rightbar_nav_item label='schedule' icon='calendar' route='schedule'
            // +rightbar_nav_item label='payroll' icon='money' route='payroll'
            +rightbar_nav_item label='orders' icon='order-history' route='orders'
            +rightbar_nav_item label='points' icon='coins' route='points'
            +rightbar_nav_item label='groups' icon='campfire' route='groups'
            +rightbar_nav_item label='checkins' icon='checked-2' route='checkins'
            +rightbar_nav_item label='sent' icon='sent' route='sent'
            +rightbar_nav_item label='topups' icon='donation' route='topups'
            +rightbar_nav_item label='friends' icon='groups' route='friends'
            // +rightbar_nav_item label='rewards' icon='prize' route='rewards'
            // +rightbar_nav_item label='orders' icon='order-history' route='orders'
                |orders
            a.ui.basic.compact.image.big.label(href="/user/#{username}/stats" class="{{isActiveRoute 'user_stats'}}")
                +i name='line-chart' cl='ui avatar image'
                |stats
                
            a.ui.image.big.label.toggle_rightbar.no_blink(href="/user/#{username}/edit" title='edit account')
                +i name='settings' cl='ui avatar image'
                |settings
            a.ui.image.big.label.logout.toggle_rightbar
                if is_logging_out
                    i.refresh.loading.icon
                else
                    +i name='exit' cl='ui avatar image'
                    // i.sign.out.icon
                |logout
            
            
template(name='rightbar_nav_item')
    a.ui.basic.big.image.label.zoomer.spaced.toggle_rightbar(href="/user/#{currentUser.username}/#{route}" class="{{isActiveRoute regex='user_checkins'}}")
        +i name=icon cl='ui avatar image'
        | #{label}
