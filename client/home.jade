template(name='transfers')
    .ui.stackable.padded.grid
        .sixteen.wide.column.scrolling
            .ui.stackable.grid 
                .four.wide.column
                    .ui.header 
                        +i name='transfer'
                        |transfers
                    unless transfer_tags.count
                        i.loading.refresh.big.icon
                    i.teal.tag.big.icon
                    each transfer_tags
                        .ui.basic.circular.label.pick_tag #{title}
                            // small #{count}
                    div
                    i.red.marker.big.icon
                    each location_tag_results
                        .ui.basic.circular.label.pick_location_tag #{title}
                            // small #{count}
                    .ui.header 
                        +i name='award'
                        |today's leaderboard
                    .ui.small.header 
                        |sent
                    .ui.large.link.selection.list
                        each most_sent_today
                            a.item(href="/user/#{username}") #{username}: #{total_sent_day}p
                    .ui.small.header 
                        |received
                    .ui.large.link.selection.list
                        each most_received_today
                            a.item(href="/user/#{username}") #{username}: #{total_received_day}p
                .twelve.wide.column
                    i.eye.grey.icon
                    // +session_set key='transfer_sort_filter' value='open'               
                    +session_set key='transfer_filter' value='now' icon='clock'            
                    +session_set key='transfer_filter' value='today' icon='sun'
                    +session_set key='transfer_filter' value=null label='all'
                    i.sort.grey.icon
                    +session_set key='transfer_sort_key' value='price'               
                    .ui.three.stackable.cards.scrolling
                        if transfer_docs.count
                            each transfer_docs
                                +transfer_item
                        else 
                            .ui.basic.segment
                                i.massive.refresh.grey.loading.icon
            
            
template(name='transfer_item')
    a.ui.link.card.fly_right(href="/transfer/#{_id}")
        if image_id
            img.ui.image(src="{{c.url image_id height=200 width=200 gravity='face' crop='fill'}}")
            // a.header(href="/transfer/#{_id}") #{title}
        .header
            .ui.big.basic.image.label
                if _author.image_id
                    img.ui.image(src="{{c.url _author.image_id height=400 width=400 gravity='face' crop='fill'}}")
                | #{_author_username}
            .ui.inline.header #{amount}
            i.large.chevron.right.grey.icon
            .ui.big.basic.image.label
                if target.image_id
                    img.ui.image(src="{{c.url target.image_id height=400 width=400 gravity='face' crop='fill'}}")
                |#{target_username}
        .content
            small #{when}
            |#{description}
            i.tag.icon
            each tags
                .ui.basic.large.circular.label #{this}
            if location_tags
                i.red.marker.icon
                each location_tags
                    .ui.basic.large.circular.label #{this}
                // if in_dev 
                //     +print_this

                    