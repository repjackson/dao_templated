template(name='tasks')
    .ui.stackable.padded.grid
        .sixteen.wide.column.scrolling
            .ui.stackable.grid 
                .four.wide.column
                    .ui.header 
                        |tasks
                        i.certificate.icon
                    .ui.fluid.icon.button.add_task
                        i.large.plus.icon
                    |view
                    // +session_set key='task_sort_filter' value='open'               
                    +session_set key='task_sort_filter' value='now'               
                    +session_set key='task_sort_filter' value='later'   
                    +session_set key='task_sort_filter' value=null label='all'
                    |delivery
                    +session_set key='task_delivery_filter' value='pickup'   
                    +session_set key='task_delivery_filter' value='delivery'   
                    +session_set key='task_delivery_filter' value=null label='all'   
                    +session_set key='task_status_filter' value='cart' label='cart' icon='cart'   
                    +session_set key='task_status_filter' value=null label='all status' icon='cart'   
                .twelve.wide.column
                    .ui.cards
                        each tasks 
                            a.card(href="/task/#{_id}")
                                .content 
                                    .header #{title}

template(name='user_tasks')
    .ui.header user tasks
template(name='task_edit')
    with current_doc
        .ui.stackable.padded.grid
            .row
                .four.wide.column
                    .ui.inline.header
                        i.pencil.icon
                        small task
                    div
                    .ui.header #{when}
                .eight.wide.column
                    +text_edit key='title' label='title' direct=true
                    +image_edit key='image_id' label='image' direct=true
                    +array_edit key='tags' label='tags' icon='tags' direct=true
                    // +array_edit key='location_tags' label='location tags' icon='marker' direct=true
                    +textarea_edit key='notes' label='notes' direct=true
                    if in_dev
                        +print_this
                    a.ui.large.fluid.icon.green.button.fly_up(href="/task/#{_id}")
                        i.large.checkmark.icon
        
        
template(name='task_view')
    with current_doc
        .ui.stackable.padded.grid
            .row
                .six.wide.column
                    a.ui.icon.button.fly_left(href="/tasks")
                        i.chevron.left.icon
                        |tasks
                    .ui.inline.header 
                        // strong '#{task_product.title}'
                        +i name='task' cl='ui avatar image'
                        |task
                    // .ui.segment 
                    //     with task_product
                    //         a(href="/product/#{_id}")
                    //             img.ui.rounded.image(src="{{c.url image_id width=400 height=400}}")
                    //         a.ui.header(href="/product/#{_id}") #{title}
                    //         // - .ui.header #{cook_tip} cook tip
                    //         // .ui.header $#{task_total_transaction_amount} 
                    //         //     small total transaction amount
                    div
                    .ui.inline.header 
                        i.clock.icon
                        small started
                        strong #{when}
                        small by
                        strong #{_author_username}
                    if can_edit 
                        a.ui.button(href="/task/#{_id}/edit")
                            i.large.pencil.icon
                .ten.wide.column
                    // img.ui.image(src="{{c.url image_id width=500 height=500 gravity='face' crop='fill'}}")
                    if image_url
                        +image_link_view key='image_url' direct=true
                    else if image_id
                        +image_view key='image_id' direct=true 
                    else if youtube_id
                        +youtube_view key='image_id' direct=true

                    .ui.header #{title}
                    each tags
                        .ui.label #{this}
                    if is_admin
                        +print_this
                    .ui.header 
                        |taskrs
                    each taskrs
                        a.ui.big.button.fly_left(href="/user/#{username}") #{username}
        