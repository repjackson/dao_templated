head
    title Backcountry
    meta(name='viewport', content='user-scalable=no, initial-scale=1.0, maximum-scale=1.0, width=device-width')
    meta(name='apple-mobile-web-app-capable', content='yes')
    meta(name='apple-mobile-web-app-status-bar-style', content='black')
    meta(name="msapplication-TileColor" content="#000000")
    meta(name="theme-color" content="#000000")
    link(rel='stylesheet' type='text/css' href='https://cdn.jsdelivr.net/npm/fomantic-ui@2.7.4/dist/semantic.min.css')
    link(href="https://fonts.googleapis.com/css?family=Ubuntu:300,400&display=swap" rel="stylesheet")
    link(rel="preconnect" href="https://fonts.gstatic.com")
    link(href="https://fonts.googleapis.com/css2?family=Benne&display=swap" rel="stylesheet")
    link(rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png")
    link(rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png")
    link(rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png")
    link(rel="manifest" href="/site.webmanifest")
    link(rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000")
    link(href="https://cdn.jsdelivr.net/npm/suneditor@latest/dist/css/suneditor.min.css" rel="stylesheet")

    script(src='https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js')
    script(src='https://cdn.jsdelivr.net/npm/fomantic-ui@2.7.4/dist/semantic.min.js')
    
    // script(src="https://cdn.jsdelivr.net/npm/sweetalert2@9")
    script(src="https://cdn.jsdelivr.net/npm/suneditor@latest/dist/suneditor.min.js")
    script(src="https://cdn.jsdelivr.net/npm/suneditor@latest/src/lang/en.js")

    // script(src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.4.1/chart.js")
    //- script(async='', src='https://www.googletagmanager.com/gtag/js?id=UA-140259454-1')
    script.
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        gtag('config', 'G-GLYPPRGJFQ');

    
template(name='layout')
    // img.ui.fluid.image.checkin_banner(src="{{c.url 'frontrange' width=1000 height=1000 crop='crop'}}")
    +nav
    .ui.bottom.attached.pushable.segment.scrolling
        +left_sidebar
        +right_sidebar
        // +topbar
        // +cartbar
        // +walletbar
        // +secnav
        if logging_in
            .ui.center.aligned.basic.segment
                i.massive.loading.yin.yang.grey.icon
        else
            .global_conainer.pusher
                unless connected
                    +status
                +yield
            // if in_role 'admin'
            //     +admin_footer
      
template(name='nav')
    #topnav.ui.fluid.inverted.attached.big.borderless.blue.menu.topnav
        unless connected
            .item 
                +status
        if connected
            if is_loading
                .icon.item
                    i.big.loading.grey.food.icon.cancel
            else 
                a.icon.item.toggle_leftbar.no_blink
                   i.bars.large.icon 
            a.header.item.zoomer.fly_left(href='/' class="{{isActiveRoute regex='home'}}")
                img.ui.avatar.image(src="https://cdn.shopify.com/s/files/1/2432/4293/files/bcplogocirclestyle-2092x2107_1024x1024.png?v=1507416868")
                span.mobile.hidden Backcountry
            // if session_is 'is_global_searching' true
            //     .ui.icon.transparent.input.global_search_input
            //         i.link.large.remove.white.icon.clear_search.zoomer(title='clear search')
            //         // if current_search
            //         // else
            //         //     i.search.icon
            //         input.global_search(type='text' value=current_search autocomplete="off")
            // else
            //     a.icon.item.init_global_search(title='search')
            //         i.search.large.icon
                
            a.icon.item.mobile.hidden(href='/events' class="{{isActiveRoute regex='events'}}" title='events')
                i.large.calendar.icon
                // |events
            a.icon.item.mobile.hidden(href='/items' class="{{isActiveRoute regex='items'}}" title='inventory')
                i.large.database.icon
                // |items
            a.icon.item.mobile.hidden(href="/food" class="{{isActiveRoute regex='food'}}" title='food')
                i.large.food.icon
                // |menu
            a.icon.item.mobile.hidden(href="/drinks" class="{{isActiveRoute regex='drinks'}}" title='drinks')
                i.large.beer.icon
                // |menu
            a.icon.item.mobile.hidden(href='/orders' class="{{isActiveRoute regex='orders'}}" title='orders')
                i.large.money.icon
                // |orders
            a.icon.item.mobile.hidden(href="/losses" class="{{isActiveRoute regex='losses'}}" title='loss')
                i.large.frown.icon
                // |losses
            a.icon.item.mobile.hidden(href="/checkins" class="{{isActiveRoute regex='checkins'}}" title='checkins')
                i.large.checkmark.icon
                // |check ins
            a.icon.item.mobile.hidden(href='/users' class="{{isActiveRoute regex='users'}}" title='users')
                i.large.users.icon
                // |users
            a.icon.item.mobile.hidden(href='/tasks' class="{{isActiveRoute regex='tasks'}}" title='tasks')
                i.large.tasks.icon
                // |users
            .right.menu
                // if currentUser
                //     a.item.log_out(title='sign out')
                //         i.sign.out.icon
                //         |sign out
                // else 
                //     a.item(href="/login" title='sign in')
                //         i.sign.in.icon
                //         |sign in
                //       .right.menu
                if currentUser
                    if logging_out
                        .icon.item
                            i.large.refresh.loading.icon
                    // if in_role 'admin'
                    //     a.icon.item(href='/admin' title='admin')
                    //         i.large.shield.icon
                    // a.icon.item.toggle_topbar(title='alerts')
                    //     i.bell.outline.large.icon
                    a.item(href="/user/#{currentUser.username}/points" class="{{isActiveRoute regex='user_points'}}")
                        // i.wallet.icon
                        strong {{int currentUser.points}}p
                    a.item.toggle_rightbar.no_blink
                        if currentUser.image_id
                            img.ui.avatar.image(src="{{c.url currentUser.image_id width=200 height=200 gravity='face'}}")
                        else
                            i.user.icon
                        strong.mobile.hidden #{currentUser.name}
                unless currentUser
                    if subs_ready
                        a.icon.item(href='/login' title='login') 
                            i.sign.in.large.icon
                    else 
                        i.food.loading.icon
         




template(name='not_found')
    .ui.center.aligned.basic.segment
        .ui.header 
            i.question.icon
            |not found
            
            
            
// template(name='topbar')
//     .ui.fluid.attached.segment.topbar.top.sidebar
//         .ui.middle.aligned.divided.list
//         .ui.list
//             each recent_alerts
//                 +recent_alert
//         a.ui.basic.button.item.close_topbar(href="/inbox")
//             i.inbox.icon
//             |inbox
        
// template(name='recent_alert')        
//     .item.alert
//         .right.floated.content
//             i.eye.link.icon.mark_read(title='mark read')
//         img.ui.avatar.image(src="{{c.url author.profile_image_id height=200 width=200 gravity='face' crop='fill'}}")
//         .content
//             .header
//                 |#{description} 
//             .description #{author.name} #{when}
            
            
            
            
// template(name='cartbar')
//     .ui.right.wide.sidebar.cartbar
//         +cart
        
// template(name='walletbar')
//     .ui.right.sidebar.walletbar
//         +user_credit
        
template(name='left_sidebar')
    .ui.left.sidebar.vertical.big.inverted.labaled.icon.blue.menu
        // a.item.toggle_leftbar.no_blink(href='/' class="{{isActivePath '/'}}" title='home')
        //     img.ui.image(src="https://rosettahall.com/wp-content/uploads/2020/12/Rosetta-White-Transparent-Art-Board.png")
        // .search.item(title='search')
        //     .ui.icon.transparent.input
        //         i.search.icon
        //         input.search_global(type='text')
        a.item.toggle_leftbar(href='/food' class="{{isActivePath '/food'}}" title='food')
            i.large.food.icon
            | food
        a.item.toggle_leftbar(href='/drinks' class="{{isActivePath '/drinks'}}" title='drinks')
            i.large.beer.icon
            | drinks
        a.item.zoomer.toggle_leftbar(href='/items' class="{{isActivePath '/items'}}")
            i.large.list.icon
            | #{items.count} items
        a.item.zoomer.toggle_leftbar(href='/tasks' class="{{isActivePath '/tasks'}}")
            i.large.tasks.icon
            | #{tasks.count} tasks
        a.item.zoomer.toggle_leftbar(href='/badges' class="{{isActivePath '/badges'}}")
            i.large.certificate.icon
            | #{badges.count} badges
        a.item.zoomer.toggle_leftbar(href='/orders' class="{{isActivePath '/orders'}}")
            i.large.money.icon
            | #{orders.count} orders
        a.item.zoomer.toggle_leftbar(href='/posts' class="{{isActivePath '/posts'}}")
            i.large.newspaper.icon
            | #{posts.count} posts
        a.item.zoomer.toggle_leftbar(href='/roles' class="{{isActivePath '/roles'}}")
            i.large.shield.icon
            | #{posts.count} roles
        // a.icon.item.zoomer.toggle_leftbar(href='/locations' class="{{isActivePath '/locations'}}")
        //     i.large.marker.icon
        //     |locations
        a.item.toggle_leftbar.zoomer(href='/users' class="{{isActivePath '/users'}}")
            i.large.user.friends.icon
            | #{users.count} users
        a.item.toggle_leftbar.zoomer(href='/groups' class="{{isActivePath '/groups'}}")
            i.large.fire.icon
            | #{users.count} groups
        a.item.toggle_leftbar.zoomer(href='/ingredients' class="{{isActivePath '/ingredients'}}")
            i.large.food.icon
            | ingredients
        // if is_in_admin
        //     a.icon.item.toggle_admin.toggle_leftbar.no_blink
        //         |toggle admin
        //         i.shield.icon
        if is_admin
            .divider
            a.item.set_model.toggle_leftbar.no_blink(href="/m/model" class="{{isActivePath '/m/model'}}")
                i.large.shield.icon
                |admin
            a.item.set_user.toggle_leftbar.no_blink(href="/users" class="{{isActiveRoute '/users'}}")
                i.large.users.icon
                | users
            a.item.toggle_leftbar.zoomer(href='/orders' class="{{isActivePath '/orders'}}" title='orders')
                i.large.list.icon
                | orders


template(name='right_sidebar')
    // .ui.right.sidebar.vertical.menu.rightbar(style="background-color:#062639;")
    .ui.right.sidebar.vertical.inverted.big.borderless.labeled.icon.blue.menu.rightbar
        a.item.toggle_rightbar.no_blink(href="/user/#{currentUser.username}" class="{{isActiveRoute 'user_layout'}}")
            img.ui.avatar.compact.image(src="{{c.url currentUser.image_id height=200 width=200 gravity='face' crop='fill'}}")
            |#{currentUser.name}
            small (#{currentUser.username})
        with currentUser
            a.item.zoomer.toggle_rightbar(href="/user/#{username}" class="{{isActiveRoute regex='user_dashboard'}}")
                i.dashboard.icon
                |dashboard
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/checkins" class="{{isActiveRoute regex='user_checkins'}}")
                i.smile.icon
                |checkins
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/points" class="{{isActiveRoute regex='user_points'}}")
                i.coins.icon
                |points
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/tasks" class="{{isActiveRoute regex='user_tasks'}}")
                i.tasks.icon
                |tasks
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/chat" class="{{isActiveRoute regex='user_chat'}}")
                i.chat.icon
                |chat
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/badges" class="{{isActiveRoute regex='user_badges'}}")
                i.certificate.icon
                |badges
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/timeclock" class="{{isActiveRoute regex='user_timeclock'}}")
                i.clock.icon
                |timeclock
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/scheduling" class="{{isActiveRoute regex='user_scheduling'}}")
                i.calendar.icon
                |scheduling
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/payroll" class="{{isActiveRoute regex='user_payroll'}}")
                i.money.icon
                |payroll
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/orders" class="{{isActiveRoute 'user_orders'}}")
                i.money.icon
                |orders
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/friends" class="{{isActiveRoute 'user_friends'}}")
                i.users.icon
                |friends
            a.item.zoomer.toggle_rightbar(href="/user/#{username}/groups" class="{{isActiveRoute 'user_groups'}}")
                i.fire.icon
                |groups
            a.item.zoomer.toggle_rightbar.no_blink(href="/user/#{currentUser.username}/edit" title='edit account')
                i.cog.icon
                |settings
            a.item.zoomer.logout.toggle_rightbar
                |logout
                if is_logging_out
                    i.refresh.loading.icon
                else
                    i.sign.out.icon
            