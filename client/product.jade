template(name='products')     
    .ui.stackable.padded.grid
        .sixteen.wide.column
            // if product_docs.count
            .ui.big.inline.header 
                // i.shop.icon
                +i name='shop'
                |#{product_docs.count} shop items
                
            if currentUser 
                .ui.circular.icon.button.add_shop
                    i.plus.icon

            
            +search_input model='shop' field='title'
            +session_set key='shop_sort' value='views' icon='eye'
            +session_set key='shop_sort' value='price_dollars' icon='money'
            // +session_set key='shop_sort_direction' value=1 icon='chevron up'
            // +session_set key='shop_sort_direction' value=-1 icon='chevron down'
            .ui.hidden.divider
            .ui.doubling.centered.four.cards.scrolling
                each product_docs
                    +product_item


template(name='product_item')
    a.card.fly_right.zoomer(href="/product/#{_id}") 
        img.ui.image(src="{{c.url image_id width=500 height=500 gravity='face' crop='fill'}}")
        .content
            .header #{title}
            each tags
                +flat_tag_picker
            span(title='views')
                |#{views}
                i.grey.eye.icon
                // .ui.basic.small.label #{this}
        .ui.fluid.big.green.button.buy
            |$#{price_points}

template(name='product_view')
    with current_doc
        .ui.stackable.padded.grid
            .row
                .five.wide.column
                    if group_id
                        a.ui.basic.large.button.fly_left(href="/group/#{group_id}")
                            i.chevron.left.icon
                            +i name='campfire' cl='ui avatar image'
                            |group
                    else
                        a.ui.basic.large.button.fly_left(href="/products")
                            i.chevron.left.icon
                            i.large.shop.icon
                            |shop
                    if can_edit
                        a.ui.icon.basic.button.fly_down(href="/product/#{_id}/edit" title='edit product')
                            i.pencil.icon

                    .ui.inline.header 
                        +i name='shop' cl='ui avatar image'
                        |product view
                        a(href="http://www.google.com/search?q=#{title}" target='_blank' title='search')
                            i.grey.search.icon
    
                    // .ui.segment 
                    //     with post_product
                    //         a(href="/product/#{_id}")
                    //             img.ui.rounded.image(src="{{c.url image_id width=400 height=400}}")
                    //         a.ui.header(href="/product/#{_id}") #{title}
                    //         // - .ui.header #{cook_tip} cook tip
                    //         // .ui.header $#{post_total_transaction_amount} 
                    //         //     small total transaction amount
                    div
                    .ui.header 
                        i.clock.icon
                        small added
                        strong #{when}
                        small by
                        strong #{_author_username}
                    +i name='tags' cl='ui avatar image'
                    each tags
                        .ui.basic.label #{this}
                    div
                    +voting_full
                    +comments
                .six.wide.column
                    h1.ui.center.aligned.big.header #{title}
                    .ui.header 
                        i.business.icon
                        |#{company}
                    // if image_url
                    //     img.ui.inline.image(src=image_url)
                    if image_id
                        img.ui.inline.rounded.image(src="{{c.url image_id width=500 height=500 gravity='face' crop='fill'}}")
                    if in_dev
                        +print_this
                .five.wide.column
                    if price_points
                        .ui.big.fluid.green.button.order_shop 
                            i.cart.big.icon
                            .ui.inline.inverted.header
                                |buy for #{price_points}pts
                    .ui.header section: #{section}
                    // .ui.header also by #{company}
                    .ui.header ratings
                    +rating icon='star' value='3'
                    +product_orders
                    if price_points
                        .ui.header #{price_points}pts
                    .ui.header #{views} views
                    if youtube_id
                        +youtube_view key='youtube_id' value='youtube id' icon='youtube'

// template(name='product_orders')
//     .ui.inline.header 
//         +i name='order-history'
//         |orders
//     if currentUser
//         i.plus.link.icon.add_order
        
//     .ui.large.selection.list
//         each order_docs
//             .item #{when} #{_author_username}
                    
                    
template(name='product_edit')
    with current_doc
        .ui.stackable.padded.grid
            .row
                .six.wide.column
                    .ui.inline.header
                        i.pencil.icon
                        |editing product
                        | #{title}
                    a.ui.fluid.icon.green.button.fly_up(href="/product/#{_id}/" title='save shop')
                        i.checkmark.big.icon
                    // a.ui.big.circular.icon.green.button.save_this(title='save')
                    +text_edit key='title' label='title' direct=true
                    +array_edit key='tags' label='tags' icon='tags' direct=true
                    // +text_edit key='model' label='model' icon='database' direct=true
                    // +image_link_edit key='image_url' label='image link' icon='image'
                .ten.wide.column
                    +image_edit key='image_id' label='image' icon='image'
                    div
                    // +number_edit key='price_dollars' label='price ($)' icon='money'
                    +number_edit key='price_points' label='price (points)' icon='coins'
                    +html_edit key='body' label='body' direct=true
                    .ui.red.large.icon.button.delete_shop(title='delete')
                        i.remove.icon   
                        // | delete
