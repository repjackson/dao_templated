head
    title Backcountry
    meta(name='viewport', content='user-scalable=no, initial-scale=1.0, maximum-scale=1.0, width=device-width')
    meta(name='apple-mobile-web-app-capable', content='yes')
    meta(name='apple-mobile-web-app-status-bar-style', content='black')
    meta(name="msapplication-TileColor" content="#000000")
    meta(name="theme-color" content="#000000")
    link(rel='stylesheet' type='text/css' href='https://cdn.jsdelivr.net/npm/fomantic-ui@2.7.4/dist/semantic.min.css')
    link(href="https://fonts.googleapis.com/css?family=Ubuntu:300,400&display=swap" rel="stylesheet")
    link(rel="preconnect" href="https://fonts.gstatic.com")
    link(href="https://fonts.googleapis.com/css2?family=Benne&display=swap" rel="stylesheet")
    link(rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png")
    link(rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png")
    link(rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png")
    link(rel="manifest" href="/site.webmanifest")
    link(rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000")
    link(href="https://cdn.jsdelivr.net/npm/suneditor@latest/dist/css/suneditor.min.css" rel="stylesheet")

    script(src='https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js')
    script(src='https://cdn.jsdelivr.net/npm/fomantic-ui@2.7.4/dist/semantic.min.js')
    
    // script(src="https://cdn.jsdelivr.net/npm/sweetalert2@9")
    script(src="https://cdn.jsdelivr.net/npm/suneditor@latest/dist/suneditor.min.js")
    script(src="https://cdn.jsdelivr.net/npm/suneditor@latest/src/lang/en.js")

    // script(src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.4.1/chart.js")
    //- script(async='', src='https://www.googletagmanager.com/gtag/js?id=UA-140259454-1')
    script.
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        gtag('config', 'G-GLYPPRGJFQ');

    
body
    +home
                

template(name='flat_tag_picker')
    .ui.label #{this}

        
        
template(name='home')
    if logging_in
        .ui.center.aligned.basic.segment
            i.massive.loading.beer.grey.icon
    else
        .ui.padded.stackable.grid
            .sixteen.wide.column
                i.pizza.slice.big.icon.add_post
                // .ui.inline.header.pointer.add_post(title="#{home_items.count} Backcountry")
                // |Backcountry
                // |#{home_items.count}
                // i.chat.outline.large.icon(title='backcountry chat')
                // if currentUser
                // i.large.link.plus.icon.add_post
                // .ui.large.icon.input(title='messages cost one point but can receive points from votes')
                //     i.plus.icon
                //     input.new_message(type='text' placeholder='quick add (-1p)')
                if tag_results
                    // .ui.inline.small.header
                    //     i.tag.icon
                    //     |tags
                    each picked_tags
                        a.ui.black.big.label.unpick_tag
                            with wiki_doc_flat
                                img(src=metadata.image)
                            |#{this}
                    each tag_results
                        +tag_picker
                // +search_input model='post' field='title'
                .ui.hidden.divider
                if current_post
                    // .ui.stackable.padded.grid
                    //     .sixteen.wide.column.scrollin
                    with current_post
                        +post_view
                            // .ui.header
                            //     |#{title}
                    // .six.wide.column.scrolling
                    //     each home_items
                    //         +home_item
                    //         // .ui.divider
                else 
                    .ui.doubling.five.cards.scrollin
                        each home_items
                            +home_item
                        
template(name='tag_picker')
    if title
        a.ui.basic.big.tertiary.link.image.label.pick_tag.zoomer(title=count)
            with wiki_doc
                img(src=metadata.image)
            |#{title} 
            // small.ui.grey.text #{count}



template(name='home_item')
    // if session_is 'editing_chat' _id
    //     .ui.item
    //         .content
    //             +text_edit key='title' direct=true
    //             i.checkmark.large.link.green.icon.save_chat   
    //             +boolean_edit key='archived' label='archived' icon='archive' direct=true
    // else
    .ui.card.zoomer.pointer.view_item(class=card_class)
        if image_id
            +image_view key='image_id' direct=true 
        if youtube_id
            +youtube_view key='image_id' direct=true
        // if is_selected
        //     .ui.header this one
        // if unless
        // else
        //     img.ui.image(src="{{c.url image_id width=500 height=500 gravity='face' crop='fill'}}")
        .content
            // a.ui.header.zoomer.fly_right(href="/post/#{_id}") !{title}
            a.ui.inline.header.zoomer !{title}
            
            // .metadata
            //     |#{when}
            //     small {{long_date _timestamp}}
            .text.view_post_quick.zoomer
                |!{body}
            span.meta
                if watson
                    +doc_emotion_small



template(name='post_card')                
    a.ui.card(href="/post/#{_id}") 
        img.ui.image(src="{{c.url image_id width=400 height=300 crop='pad'}}")
        if youtube_id
            +youtube_view key='youtube_id' direct=true
        .content 
            .ui.header 
                |#{title}
            i.grey.tag.icon
            each tags
                .ui.label #{this}
            if location_tags
                i.grey.marker.icon
                each location_tags
                    .ui.small.label #{this}
            if people_tags
                i.grey.marker.icon
                each people_tags
                    .ui.small.label #{this}


                
template(name='post_edit')
    with current_doc
        .ui.stackable.padded.grid
            .row
                .eight.wide.column
                    .ui.inline.header
                        i.pencil.icon
                        | #{title}
                    // a.ui.large.icon.green.button(href="/post/#{_id}/" title='save product')
                    a.ui.big.circular.icon.green.button.save_post(href="/" title='save post')
                        i.checkmark.big.icon
                    +text_edit key='title' label='title' direct=true
                    +image_edit key='image_id' label='image' icon='image'
                    +number_edit key='price_dollars' label='price ($)' icon='money'
                .eight.wide.column
                    +html_edit key='body' label='body' direct=true
                    +array_edit key='tags' label='tags' icon='tags' direct=true
                    .ui.red.button.delete_post
                        i.remove.icon   
                        | delete
                
                
template(name='post_view')
    // with current_doc
    .ui.stackable.padded.grid.scrollin
        .row.clear_current_post.pointer.zoomer
            .sixteen.wide.column
                // .ui.basic.icon.circular.button.fly_up(title='clear selection')
                //     i.chevron.remove.red.large.icon
                .ui.inline.header
                    | #{title}
                +image_view key='image_id' direct=true
                +html_view key='body' direct=true
                // +html_view key='content' direct=true
                // +html_view key='description' direct=true
                +array_view key='tags' direct=true
                if youtube_id
                    +youtube_view key='youtube_id' direct=true
                // .ui.header 
                //     i.users.icon
                //     |audience
                // +comments
                if watson
                    +watson_view
                if tone 
                    +tone_view
                if can_edit
                    a.ui.icon.large.basic.button(href="/post/#{_id}/edit")
                        i.pencil.blue.icon
                // .ui.large.basic.label added #{when}
                if body
                    +call_watson key='body' mode='html'
                    +call_tone key='body'
                // each _timestamp_tags
                //     .ui.label #{this}
                // if in_dev
                //     +print_this
                // .ui.basic.label
                //     |views
                //     |#{views}
                // div
                // div
                // +voting_full
                // +boolean_view key='published' label='published' direct=true
                
                
                
